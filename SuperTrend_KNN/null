{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "5d7ac58d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-06-03T12:59:39.819779Z",
     "iopub.status.busy": "2024-06-03T12:59:39.819779Z",
     "iopub.status.idle": "2024-06-03T12:59:41.188284Z",
     "shell.execute_reply": "2024-06-03T12:59:41.187286Z"
    },
    "id": "0g6HfXHrHN36",
    "papermill": {
     "duration": 1.372493,
     "end_time": "2024-06-03T12:59:41.192272",
     "exception": false,
     "start_time": "2024-06-03T12:59:39.819779",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "import yfinance as yf\n",
    "from tqdm import tqdm\n",
    "from bs4 import BeautifulSoup\n",
    "from urllib.request import urlopen, Request\n",
    "\n",
    "def DataFetcher(symbol,interval='1d'):\n",
    "    suffixes = ['.NS', '.BO']\n",
    "    for suffix in suffixes:\n",
    "        try:\n",
    "            data = yf.download(symbol + suffix, interval=interval,progress=False)\n",
    "            data.drop(columns='Adj Close', inplace=True)\n",
    "            data['Time'] = data.index\n",
    "            data.rename(columns={'Open': 'Open', 'High': 'high', 'Low': 'low', 'Close': 'close', 'Volume': 'Volume'}, inplace=True)\n",
    "            return data\n",
    "        except Exception as e:\n",
    "            print(f\"Failed to fetch data for {symbol+suffix}: {e}\")\n",
    "    return pd.DataFrame()  # Return an empty DataFrame if both fetches fail\n",
    "\n",
    "\n",
    "def rma(close, length):\n",
    "    alpha = 1 / length\n",
    "    rma_values = np.zeros_like(close, dtype=float)\n",
    "    rma_values[length - 1] = np.mean(close[:length])  # Initial SMA calculation\n",
    "\n",
    "    for i in range(length, len(close)):\n",
    "        rma_values[i] = alpha * close[i] + (1 - alpha) * rma_values[i - 1]\n",
    "\n",
    "    return rma_values\n",
    "\n",
    "def calculate_wma(values, length):\n",
    "    wma_values = []\n",
    "    for i in range(len(values)):\n",
    "        if i+1 < length:\n",
    "            wma_values.append(None)  # Insufficient data to calculate WMA\n",
    "        else:\n",
    "            window = values[i-length+1:i+1]\n",
    "            weights = np.arange(1, length + 1)\n",
    "            wma = np.dot(window, weights) / weights.sum()\n",
    "            wma_values.append(wma)\n",
    "    return wma_values\n",
    "def calculate_supertrend(df, length=10, factor=3.0, ma_type='WMA'):\n",
    "    df = df.reset_index(drop=True)\n",
    "    df['cv']=df['close'] * df['Volume']\n",
    "    df['cv_wma']= calculate_wma(df['cv'].tolist(), length)\n",
    "    df['v_wma']=calculate_wma(df['Volume'].tolist(),length)\n",
    "    df['vwma']= df['cv_wma'] / df['v_wma']\n",
    "\n",
    "    # Calculate True Range and ATR\n",
    "    df['custom_true_range'] = np.where(np.isnan(df['high'].shift(1)), df['high'] - df['low'],\n",
    "                                       np.maximum(np.maximum(df['high'] - df['low'], np.abs(df['high'] - df['close'].shift(1))),\n",
    "                                                  np.abs(df['low'] - df['close'].shift(1))))\n",
    "    atr = rma(df['custom_true_range'].values, length)\n",
    "    df['atr'] = atr\n",
    "\n",
    "    # Calculate upper and lower bands\n",
    "    df['upperBand'] = df['vwma'] + factor * df['atr']\n",
    "    df['lowerBand'] = df['vwma'] - factor * df['atr']\n",
    "\n",
    "    # Initialize columns to avoid forward reference\n",
    "    df['prevLowerBand'] = df['lowerBand'].shift(1)\n",
    "    df['prevUpperBand'] = df['upperBand'].shift(1)\n",
    "\n",
    "    df['direction'] = np.nan\n",
    "    df['superTrend'] = np.nan\n",
    "\n",
    "\n",
    "\n",
    "    for i in range(1, len(df)):\n",
    "        df.loc[i, 'lowerBand'] = df.loc[i, 'lowerBand'] if df.loc[i, 'lowerBand'] > df.loc[i, 'prevLowerBand'] or df.loc[i-1, 'close'] < df.loc[i, 'prevLowerBand'] else df.loc[i, 'prevLowerBand']\n",
    "        df.loc[i, 'upperBand'] = df.loc[i, 'upperBand'] if df.loc[i, 'upperBand'] < df.loc[i, 'prevUpperBand'] or df.loc[i-1, 'close'] > df.loc[i, 'prevUpperBand'] else df.loc[i, 'prevUpperBand']\n",
    "\n",
    "        if pd.isna(df.loc[i-1, 'atr']):\n",
    "            df.loc[i, 'direction'] = 1\n",
    "        elif df.loc[i-1, 'superTrend'] == df.loc[i, 'prevUpperBand']:\n",
    "            df.loc[i, 'direction'] = -1 if df.loc[i, 'close'] > df.loc[i, 'upperBand'] else 1\n",
    "        else:\n",
    "            df.loc[i, 'direction'] = 1 if df.loc[i, 'close'] < df.loc[i, 'lowerBand'] else -1\n",
    "\n",
    "        df.loc[i, 'superTrend'] = df.loc[i, 'lowerBand'] if df.loc[i, 'direction'] == -1 else df.loc[i, 'upperBand']\n",
    "    df.drop(columns=['cv', 'cv_wma', 'v_wma', 'custom_true_range', 'vwma', 'prevLowerBand', 'prevUpperBand'], inplace=True)\n",
    "    #df.dropna(inplace=True)\n",
    "    return df\n",
    "\n",
    "def price_sp_wma (df):\n",
    "  df['price_WMA']=calculate_wma(df['close'], 20)\n",
    "  df['superTrend_WMA']=calculate_wma(df['superTrend'], 100)\n",
    "  df.dropna(inplace=True)\n",
    "  return df\n",
    "\n",
    "def calculate_data_point(df,n\n",
    "                         ):\n",
    "    data_points = []\n",
    "    label = []\n",
    "    for i in range(len(df)-1, len(df) - 1 - n, -1):\n",
    "        data_points.append(df['superTrend'].iloc[i])\n",
    "        label_i = 1 if df['price_WMA'].iloc[i] > df['superTrend_WMA'].iloc[i] else 0\n",
    "        label.append(label_i)\n",
    "    return data_points, label\n",
    "\n",
    "def calculate_data_points(df,window_size=10):\n",
    "  data = []\n",
    "  labels = []\n",
    "  for i in range(window_size, len(df)):\n",
    "    data_point,label=calculate_data_point(df[i-window_size:i],window_size)\n",
    "    data.append(data_point)\n",
    "    labels.append(label)\n",
    "  return np.array(data), np.array(labels)\n",
    "\n",
    "\n",
    "def knn_weighted_series(data, labels, k, x):\n",
    "    # Ensure data and labels are pandas Series\n",
    "    if not isinstance(data, pd.Series) or not isinstance(labels, pd.Series):\n",
    "        raise ValueError(\"Data and labels must be Pandas Series.\")\n",
    "\n",
    "    # Calculate distances using numpy for vectorized operations\n",
    "    distances = np.abs(data - x)\n",
    "\n",
    "    # Sort the distances and get the indices of the sorted items\n",
    "    sorted_indices = distances.argsort()\n",
    "\n",
    "    # Select the k nearest neighbors\n",
    "    nearest_indices = sorted_indices[:k]\n",
    "\n",
    "    # Calculate weights, which are inversely proportional to the distance\n",
    "    weights = 1 / (distances.iloc[nearest_indices] + 1e-6)\n",
    "    weighted_labels = weights * labels.iloc[nearest_indices]\n",
    "\n",
    "    weighted_sum = weighted_labels.sum()\n",
    "    total_weight = weights.sum()\n",
    "\n",
    "    return weighted_sum / total_weight if total_weight else 0\n",
    "\n",
    "def apply_corrected_trading_logic(df):\n",
    "    df = df.reset_index(drop=True)\n",
    "    last_signal = 'none'\n",
    "    signals = ['none'] * len(df)  # Initialize all signals to 'none'\n",
    "    \n",
    "    for i in range(1, len(df)):\n",
    "        if last_signal != 'long' and ((df.loc[i, 'label_'] == 1 and (df.loc[i-1, 'label_'] != 1 or df.loc[i-1, 'label_'] not in [1,0] )) or (df.loc[i, 'direction'] == -1 and df.loc[i-1, 'direction'] == 1 and df.loc[i, 'label_'] == 1)):\n",
    "            signals[i] = 'Buy'\n",
    "            last_signal = 'long'\n",
    "        elif last_signal == 'long' and ((df.loc[i, 'close'] < df.loc[i, 'longTrailingStop']) or (df.loc[i, 'label_'] == 1 and df.loc[i, 'direction']== 1) or (df.loc[i, 'label_'] == 0 and df.loc[i, 'direction']==  -1 ) ):\n",
    "            signals[i] = 'Sell'\n",
    "            last_signal = 'none'\n",
    "        # Add additional elif blocks here to handle other conditions, such as short entry and exit\n",
    "\n",
    "    df['signal'] = signals\n",
    "    return df[df['signal'] != 'none']\n",
    "\n",
    "def fetch_last_n_days_data(df, n):\n",
    "    return df[df['Time'] >=  pd.Timestamp.now() - pd.Timedelta(days=n)]\n",
    "\n",
    "def get_market_cap(symbol):\n",
    "    link = f'https://www.screener.in/company/{symbol}'\n",
    "    hdr = {'User-Agent':'Mozilla/5.0'}\n",
    "    req = Request(link,headers=hdr)\n",
    "    market_cap = 0.0\n",
    "\n",
    "    try:\n",
    "        page = urlopen(req)\n",
    "        soup = BeautifulSoup(page, 'html.parser')\n",
    "\n",
    "        div_html = soup.find('div',{'class': 'company-ratios'})\n",
    "        ul_html = div_html.find('ul',{'id': 'top-ratios'})\n",
    "\n",
    "        for li in ul_html.find_all(\"li\"):\n",
    "            name_span = li.find('span',{'class':'name'})\n",
    "            if 'Market Cap' in name_span.text:\n",
    "                num_span = li.find('span',{'class':'number'})\n",
    "                num_span = num_span.text.replace(',', '')\n",
    "                market_cap = float(num_span) if (num_span != '') else 0.0\n",
    "                break\n",
    "\n",
    "        return market_cap\n",
    "\n",
    "    except Exception as e:\n",
    "        return -1\n",
    "\n",
    "\n",
    "\n",
    "def main(df):\n",
    "  df=calculate_supertrend(df)\n",
    "  df=price_sp_wma(df)\n",
    "  data,labels =calculate_data_points(df)\n",
    "  df=df[10:]\n",
    "  data = [pd.Series(arr) for arr in data]\n",
    "  lables = [pd.Series(arr) for arr in labels]\n",
    "  df['data']=data\n",
    "  df['labels']=lables\n",
    "  df['label_'] = df.apply(lambda row: knn_weighted_series(row['data'], row['labels'], 3, row['superTrend']), axis=1)\n",
    "  df.drop(columns=['data','labels','price_WMA','superTrend_WMA'], inplace=True)\n",
    "  df['longTrailingStop'] = df['superTrend'] - (df['atr'] * 3)\n",
    "  df = apply_corrected_trading_logic(df)\n",
    "  df=df[['Time','close','signal']][df['signal'] != 'none']\n",
    "  df= fetch_last_n_days_data(df,1)\n",
    "  return df\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "1fc18e6a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-06-03T12:59:41.208604Z",
     "iopub.status.busy": "2024-06-03T12:59:41.207607Z",
     "iopub.status.idle": "2024-06-03T12:59:41.238211Z",
     "shell.execute_reply": "2024-06-03T12:59:41.237207Z"
    },
    "id": "x8BgXOlsImos",
    "papermill": {
     "duration": 0.039953,
     "end_time": "2024-06-03T12:59:41.241202",
     "exception": false,
     "start_time": "2024-06-03T12:59:41.201249",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "stocks_df=pd.read_csv('STOCKS_1.csv')\n",
    "stocks_df = stocks_df.dropna(subset=['Symbol'])\n",
    "stocks=stocks_df['Symbol']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "8413746c",
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "execution": {
     "iopub.execute_input": "2024-06-03T12:59:41.251329Z",
     "iopub.status.busy": "2024-06-03T12:59:41.250331Z",
     "iopub.status.idle": "2024-06-03T15:27:55.696392Z",
     "shell.execute_reply": "2024-06-03T15:27:55.694881Z"
    },
    "id": "9rt8A82KJjIC",
    "outputId": "76ac0699-600e-490e-cad0-f677d04c3bde",
    "papermill": {
     "duration": 8894.45704,
     "end_time": "2024-06-03T15:27:55.700390",
     "exception": false,
     "start_time": "2024-06-03T12:59:41.243350",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:   0%|          | 0/461 [00:00<?, ?stock/s]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:   0%|          | 1/461 [00:01<10:57,  1.43s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:   0%|          | 2/461 [00:16<1:12:51,  9.52s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:   1%|          | 3/461 [00:23<1:02:16,  8.16s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:   1%|          | 4/461 [00:24<41:19,  5.43s/stock]  "
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:   1%|          | 5/461 [01:10<2:32:54, 20.12s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:   1%|▏         | 6/461 [01:52<3:27:57, 27.42s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:   2%|▏         | 7/461 [02:32<3:59:47, 31.69s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:   2%|▏         | 8/461 [02:59<3:47:37, 30.15s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:   2%|▏         | 9/461 [03:00<2:38:15, 21.01s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:   2%|▏         | 10/461 [03:01<1:51:38, 14.85s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:   2%|▏         | 11/461 [03:27<2:16:29, 18.20s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:   3%|▎         | 12/461 [03:52<2:32:19, 20.35s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:   3%|▎         | 13/461 [03:53<1:48:21, 14.51s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:   3%|▎         | 14/461 [04:07<1:46:42, 14.32s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:   3%|▎         | 15/461 [04:08<1:17:28, 10.42s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:   3%|▎         | 16/461 [04:09<56:13,  7.58s/stock]  "
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:   4%|▎         | 17/461 [04:42<1:51:33, 15.08s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:   4%|▍         | 18/461 [04:43<1:20:20, 10.88s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:   4%|▍         | 19/461 [04:44<58:28,  7.94s/stock]  "
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:   4%|▍         | 20/461 [05:18<1:56:31, 15.85s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:   5%|▍         | 21/461 [05:21<1:26:56, 11.85s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:   5%|▍         | 22/461 [06:04<2:36:21, 21.37s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:   5%|▍         | 23/461 [06:05<1:50:58, 15.20s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:   5%|▌         | 24/461 [06:19<1:47:31, 14.76s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:   5%|▌         | 25/461 [06:20<1:17:11, 10.62s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:   6%|▌         | 26/461 [06:54<2:08:55, 17.78s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:   6%|▌         | 27/461 [07:24<2:33:26, 21.21s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:   6%|▌         | 28/461 [07:39<2:19:39, 19.35s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:   6%|▋         | 29/461 [07:40<1:40:14, 13.92s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:   7%|▋         | 30/461 [07:53<1:39:12, 13.81s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:   7%|▋         | 31/461 [08:00<1:22:56, 11.57s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:   7%|▋         | 32/461 [08:10<1:19:56, 11.18s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:   7%|▋         | 33/461 [08:24<1:26:36, 12.14s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:   7%|▋         | 34/461 [08:56<2:08:32, 18.06s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:   8%|▊         | 35/461 [08:57<1:31:19, 12.86s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:   8%|▊         | 36/461 [09:32<2:17:31, 19.42s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:   8%|▊         | 37/461 [09:44<2:01:07, 17.14s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:   8%|▊         | 38/461 [10:16<2:33:33, 21.78s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:   8%|▊         | 39/461 [10:17<1:49:32, 15.57s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:   9%|▊         | 40/461 [10:18<1:18:37, 11.20s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:   9%|▉         | 41/461 [10:22<1:03:15,  9.04s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:   9%|▉         | 42/461 [11:05<2:14:17, 19.23s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:   9%|▉         | 43/461 [12:06<3:40:25, 31.64s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  10%|▉         | 44/461 [12:34<3:33:01, 30.65s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  10%|▉         | 45/461 [12:36<2:31:19, 21.83s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  10%|▉         | 46/461 [12:37<1:48:15, 15.65s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  10%|█         | 47/461 [13:10<2:23:22, 20.78s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  10%|█         | 48/461 [13:50<3:03:19, 26.63s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  11%|█         | 49/461 [13:54<2:16:09, 19.83s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  11%|█         | 50/461 [14:30<2:49:36, 24.76s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  11%|█         | 51/461 [14:31<2:00:45, 17.67s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  11%|█▏        | 52/461 [14:43<1:49:06, 16.01s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  11%|█▏        | 53/461 [14:50<1:29:46, 13.20s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  12%|█▏        | 54/461 [14:51<1:04:17,  9.48s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  12%|█▏        | 55/461 [14:59<1:02:05,  9.18s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  12%|█▏        | 56/461 [15:00<45:08,  6.69s/stock]  "
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  12%|█▏        | 57/461 [15:03<37:20,  5.54s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  13%|█▎        | 58/461 [15:36<1:33:26, 13.91s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  13%|█▎        | 59/461 [16:10<2:11:59, 19.70s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  13%|█▎        | 60/461 [16:11<1:34:51, 14.19s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  13%|█▎        | 61/461 [16:12<1:07:33, 10.13s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  13%|█▎        | 62/461 [17:11<2:46:10, 24.99s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  14%|█▎        | 63/461 [17:56<3:25:31, 30.98s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  14%|█▍        | 64/461 [17:57<2:25:39, 22.01s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  14%|█▍        | 65/461 [18:30<2:47:25, 25.37s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  14%|█▍        | 66/461 [19:29<3:52:33, 35.33s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  15%|█▍        | 67/461 [20:14<4:11:12, 38.26s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  15%|█▍        | 68/461 [20:53<4:10:47, 38.29s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  15%|█▍        | 69/461 [20:54<2:57:23, 27.15s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  15%|█▌        | 70/461 [21:29<3:13:43, 29.73s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  15%|█▌        | 71/461 [22:14<3:42:09, 34.18s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  16%|█▌        | 72/461 [22:15<2:37:38, 24.31s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  16%|█▌        | 73/461 [23:01<3:18:30, 30.70s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  16%|█▌        | 74/461 [23:02<2:20:57, 21.85s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  16%|█▋        | 75/461 [23:03<1:40:22, 15.60s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  16%|█▋        | 76/461 [23:40<2:20:22, 21.88s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  17%|█▋        | 77/461 [23:41<1:40:04, 15.64s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  17%|█▋        | 78/461 [23:42<1:12:22, 11.34s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  17%|█▋        | 79/461 [23:45<57:01,  8.96s/stock]  "
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  17%|█▋        | 80/461 [23:47<42:11,  6.64s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  18%|█▊        | 81/461 [23:48<32:04,  5.06s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  18%|█▊        | 82/461 [23:49<24:43,  3.92s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  18%|█▊        | 83/461 [23:53<25:00,  3.97s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  18%|█▊        | 84/461 [24:09<46:57,  7.47s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  18%|█▊        | 85/461 [24:10<35:02,  5.59s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  19%|█▊        | 86/461 [25:06<2:08:21, 20.54s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  19%|█▉        | 87/461 [25:44<2:41:52, 25.97s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  19%|█▉        | 88/461 [25:45<1:54:39, 18.44s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  19%|█▉        | 89/461 [25:46<1:21:52, 13.20s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  20%|█▉        | 90/461 [25:47<59:38,  9.65s/stock]  "
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  20%|█▉        | 91/461 [26:33<2:05:54, 20.42s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  20%|█▉        | 92/461 [26:34<1:29:19, 14.52s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  20%|██        | 93/461 [26:35<1:04:36, 10.53s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  20%|██        | 94/461 [26:42<58:12,  9.52s/stock]  "
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  21%|██        | 95/461 [26:56<1:06:29, 10.90s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  21%|██        | 96/461 [26:58<48:40,  8.00s/stock]  "
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  21%|██        | 97/461 [27:42<1:54:26, 18.86s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  21%|██▏       | 98/461 [27:43<1:22:18, 13.60s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  21%|██▏       | 99/461 [28:42<2:44:58, 27.34s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  22%|██▏       | 100/461 [28:43<1:56:27, 19.35s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  22%|██▏       | 101/461 [28:44<1:22:34, 13.76s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  22%|██▏       | 102/461 [28:45<59:52, 10.01s/stock]  "
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  22%|██▏       | 103/461 [28:46<44:09,  7.40s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  23%|██▎       | 104/461 [29:13<1:18:35, 13.21s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  23%|██▎       | 105/461 [29:17<1:02:14, 10.49s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  23%|██▎       | 106/461 [29:19<46:11,  7.81s/stock]  "
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  23%|██▎       | 107/461 [30:03<1:50:19, 18.70s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  23%|██▎       | 108/461 [30:48<2:36:07, 26.54s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  24%|██▎       | 109/461 [30:49<1:51:31, 19.01s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  24%|██▍       | 110/461 [31:33<2:34:39, 26.44s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  24%|██▍       | 111/461 [32:18<3:05:54, 31.87s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  24%|██▍       | 112/461 [32:45<2:56:53, 30.41s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  25%|██▍       | 113/461 [32:46<2:05:19, 21.61s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  25%|██▍       | 114/461 [33:31<2:45:24, 28.60s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  25%|██▍       | 115/461 [33:38<2:08:22, 22.26s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  25%|██▌       | 116/461 [33:42<1:35:32, 16.62s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  25%|██▌       | 117/461 [34:00<1:38:37, 17.20s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  26%|██▌       | 118/461 [34:01<1:11:00, 12.42s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  26%|██▌       | 119/461 [34:03<52:05,  9.14s/stock]  "
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  26%|██▌       | 120/461 [34:46<1:50:21, 19.42s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  26%|██▌       | 121/461 [35:44<2:55:01, 30.89s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  26%|██▋       | 122/461 [35:45<2:04:18, 22.00s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  27%|██▋       | 123/461 [35:47<1:29:32, 15.89s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  27%|██▋       | 124/461 [35:48<1:04:26, 11.47s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  27%|██▋       | 125/461 [35:49<47:13,  8.43s/stock]  "
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  27%|██▋       | 126/461 [36:26<1:34:01, 16.84s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  28%|██▊       | 127/461 [36:51<1:48:31, 19.50s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  28%|██▊       | 128/461 [37:36<2:29:17, 26.90s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  28%|██▊       | 129/461 [37:47<2:03:42, 22.36s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  28%|██▊       | 130/461 [37:48<1:27:32, 15.87s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  28%|██▊       | 131/461 [37:53<1:09:40, 12.67s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  29%|██▊       | 132/461 [38:37<2:00:54, 22.05s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  29%|██▉       | 133/461 [38:40<1:29:34, 16.38s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  29%|██▉       | 134/461 [38:42<1:04:20, 11.81s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  29%|██▉       | 135/461 [38:43<47:02,  8.66s/stock]  "
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  30%|██▉       | 136/461 [38:44<35:04,  6.47s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  30%|██▉       | 137/461 [38:53<39:28,  7.31s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  30%|██▉       | 138/461 [38:54<28:50,  5.36s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  30%|███       | 139/461 [39:40<1:33:52, 17.49s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  30%|███       | 140/461 [39:41<1:07:34, 12.63s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  31%|███       | 141/461 [39:54<1:07:38, 12.68s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  31%|███       | 142/461 [39:55<49:05,  9.23s/stock]  "
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  31%|███       | 143/461 [40:31<1:30:33, 17.09s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  31%|███       | 144/461 [41:16<2:15:02, 25.56s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  31%|███▏      | 145/461 [41:17<1:36:12, 18.27s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  32%|███▏      | 146/461 [41:18<1:08:51, 13.12s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  32%|███▏      | 147/461 [41:51<1:39:45, 19.06s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  32%|███▏      | 148/461 [41:55<1:14:31, 14.29s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  32%|███▏      | 149/461 [42:36<1:56:17, 22.36s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  33%|███▎      | 150/461 [43:20<2:30:16, 28.99s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  33%|███▎      | 151/461 [44:14<3:08:34, 36.50s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  33%|███▎      | 152/461 [44:27<2:31:53, 29.49s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  33%|███▎      | 153/461 [45:03<2:40:51, 31.34s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  33%|███▎      | 154/461 [45:04<1:53:53, 22.26s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  34%|███▎      | 155/461 [45:05<1:21:28, 15.97s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  34%|███▍      | 156/461 [45:24<1:25:58, 16.91s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  34%|███▍      | 157/461 [45:30<1:08:35, 13.54s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  34%|███▍      | 158/461 [46:06<1:41:28, 20.09s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  34%|███▍      | 159/461 [46:07<1:12:19, 14.37s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  35%|███▍      | 160/461 [46:20<1:11:19, 14.22s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  35%|███▍      | 161/461 [47:01<1:49:59, 22.00s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  35%|███▌      | 162/461 [47:02<1:18:24, 15.73s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  35%|███▌      | 163/461 [47:03<57:04, 11.49s/stock]  "
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  36%|███▌      | 164/461 [47:08<46:32,  9.40s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  36%|███▌      | 165/461 [47:45<1:27:48, 17.80s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  36%|███▌      | 166/461 [47:46<1:03:06, 12.84s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  36%|███▌      | 167/461 [47:48<45:46,  9.34s/stock]  "
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  36%|███▋      | 168/461 [48:32<1:36:33, 19.77s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  37%|███▋      | 169/461 [48:34<1:10:14, 14.43s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  37%|███▋      | 170/461 [48:35<50:41, 10.45s/stock]  "
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  37%|███▋      | 171/461 [49:13<1:30:46, 18.78s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  37%|███▋      | 172/461 [49:52<1:58:55, 24.69s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  38%|███▊      | 173/461 [50:37<2:28:21, 30.91s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  38%|███▊      | 174/461 [51:22<2:47:51, 35.09s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  38%|███▊      | 175/461 [51:59<2:50:53, 35.85s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  38%|███▊      | 176/461 [52:01<2:01:35, 25.60s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  38%|███▊      | 177/461 [53:01<2:49:21, 35.78s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  39%|███▊      | 178/461 [53:02<1:59:28, 25.33s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  39%|███▉      | 179/461 [53:55<2:38:18, 33.68s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  39%|███▉      | 180/461 [54:09<2:10:24, 27.84s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  39%|███▉      | 181/461 [54:10<1:32:50, 19.90s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  39%|███▉      | 182/461 [54:55<2:07:32, 27.43s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  40%|███▉      | 183/461 [54:56<1:30:01, 19.43s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  40%|███▉      | 184/461 [54:58<1:04:46, 14.03s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  40%|████      | 185/461 [55:43<1:48:14, 23.53s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  40%|████      | 186/461 [56:29<2:18:01, 30.11s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  41%|████      | 187/461 [56:36<1:46:03, 23.22s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  41%|████      | 188/461 [57:23<2:17:35, 30.24s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  41%|████      | 189/461 [58:08<2:37:34, 34.76s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  41%|████      | 190/461 [58:46<2:41:38, 35.79s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  41%|████▏     | 191/461 [58:47<1:54:19, 25.41s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  42%|████▏     | 192/461 [58:49<1:21:34, 18.19s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  42%|████▏     | 193/461 [58:50<58:16, 13.05s/stock]  "
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  42%|████▏     | 194/461 [59:21<1:22:57, 18.64s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  42%|████▏     | 195/461 [59:27<1:05:19, 14.73s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  43%|████▎     | 196/461 [1:00:11<1:44:27, 23.65s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  43%|████▎     | 197/461 [1:00:56<2:11:37, 29.91s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  43%|████▎     | 198/461 [1:01:09<1:49:26, 24.97s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  43%|████▎     | 199/461 [1:01:46<2:04:15, 28.45s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  43%|████▎     | 200/461 [1:01:51<1:33:01, 21.38s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  44%|████▎     | 201/461 [1:02:06<1:25:06, 19.64s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  44%|████▍     | 202/461 [1:02:50<1:56:18, 26.94s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  44%|████▍     | 203/461 [1:03:25<2:05:47, 29.25s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  44%|████▍     | 204/461 [1:03:56<2:08:09, 29.92s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  44%|████▍     | 205/461 [1:04:02<1:36:15, 22.56s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  45%|████▍     | 206/461 [1:04:54<2:14:00, 31.53s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  45%|████▍     | 207/461 [1:04:55<1:34:49, 22.40s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  45%|████▌     | 208/461 [1:05:10<1:24:18, 19.99s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  45%|████▌     | 209/461 [1:05:54<1:54:41, 27.31s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  46%|████▌     | 210/461 [1:06:40<2:17:43, 32.92s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  46%|████▌     | 211/461 [1:07:10<2:12:40, 31.84s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  46%|████▌     | 212/461 [1:07:11<1:34:16, 22.72s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  46%|████▌     | 213/461 [1:07:50<1:54:34, 27.72s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  46%|████▋     | 214/461 [1:07:52<1:21:50, 19.88s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  47%|████▋     | 215/461 [1:08:09<1:18:15, 19.09s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  47%|████▋     | 216/461 [1:08:10<55:42, 13.64s/stock]  "
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  47%|████▋     | 217/461 [1:08:11<39:43,  9.77s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  47%|████▋     | 218/461 [1:08:12<29:23,  7.26s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  48%|████▊     | 219/461 [1:08:13<21:29,  5.33s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  48%|████▊     | 220/461 [1:08:14<15:52,  3.95s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  48%|████▊     | 221/461 [1:08:52<56:36, 14.15s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  48%|████▊     | 222/461 [1:08:52<40:21, 10.13s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  48%|████▊     | 223/461 [1:09:05<43:16, 10.91s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  49%|████▊     | 224/461 [1:09:07<32:01,  8.11s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  49%|████▉     | 225/461 [1:09:24<42:38, 10.84s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  49%|████▉     | 226/461 [1:09:25<30:52,  7.88s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  49%|████▉     | 227/461 [1:10:03<1:05:39, 16.83s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  49%|████▉     | 228/461 [1:10:32<1:19:20, 20.43s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  50%|████▉     | 229/461 [1:10:32<56:11, 14.53s/stock]  "
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  50%|████▉     | 230/461 [1:10:50<59:21, 15.42s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  50%|█████     | 231/461 [1:11:31<1:28:48, 23.17s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  50%|█████     | 232/461 [1:12:16<1:53:38, 29.77s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  51%|█████     | 233/461 [1:13:05<2:14:59, 35.52s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  51%|█████     | 234/461 [1:13:34<2:07:01, 33.57s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  51%|█████     | 235/461 [1:14:24<2:24:43, 38.42s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  51%|█████     | 236/461 [1:14:43<2:02:03, 32.55s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  51%|█████▏    | 237/461 [1:14:52<1:35:38, 25.62s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  52%|█████▏    | 238/461 [1:15:36<1:55:53, 31.18s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  52%|█████▏    | 239/461 [1:16:04<1:51:35, 30.16s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  52%|█████▏    | 240/461 [1:16:41<1:58:39, 32.21s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  52%|█████▏    | 241/461 [1:16:48<1:30:07, 24.58s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  52%|█████▏    | 242/461 [1:16:49<1:04:15, 17.61s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  53%|█████▎    | 243/461 [1:16:51<46:12, 12.72s/stock]  "
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  53%|█████▎    | 244/461 [1:17:14<58:01, 16.05s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  53%|█████▎    | 245/461 [1:17:26<52:39, 14.63s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  53%|█████▎    | 246/461 [1:17:31<41:55, 11.70s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  54%|█████▎    | 247/461 [1:17:31<30:02,  8.42s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  54%|█████▍    | 248/461 [1:17:32<21:45,  6.13s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  54%|█████▍    | 249/461 [1:17:33<15:55,  4.51s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  54%|█████▍    | 250/461 [1:18:31<1:12:40, 20.67s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  54%|█████▍    | 251/461 [1:18:33<52:55, 15.12s/stock]  "
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  55%|█████▍    | 252/461 [1:19:13<1:18:29, 22.53s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  55%|█████▍    | 253/461 [1:19:47<1:29:25, 25.79s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  55%|█████▌    | 254/461 [1:19:48<1:03:22, 18.37s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  55%|█████▌    | 255/461 [1:19:49<45:35, 13.28s/stock]  "
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  56%|█████▌    | 256/461 [1:20:34<1:17:18, 22.62s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  56%|█████▌    | 257/461 [1:20:49<1:09:19, 20.39s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  56%|█████▌    | 258/461 [1:21:34<1:34:34, 27.96s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  56%|█████▌    | 259/461 [1:22:26<1:58:18, 35.14s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  56%|█████▋    | 260/461 [1:22:28<1:23:45, 25.00s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  57%|█████▋    | 261/461 [1:22:46<1:16:47, 23.04s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  57%|█████▋    | 262/461 [1:22:47<54:29, 16.43s/stock]  "
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  57%|█████▋    | 263/461 [1:23:07<57:42, 17.49s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  57%|█████▋    | 264/461 [1:23:08<41:36, 12.67s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  57%|█████▋    | 265/461 [1:23:27<47:32, 14.55s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  58%|█████▊    | 266/461 [1:24:03<1:07:59, 20.92s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  58%|█████▊    | 267/461 [1:24:04<48:27, 14.99s/stock]  "
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  58%|█████▊    | 268/461 [1:24:17<46:05, 14.33s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  58%|█████▊    | 269/461 [1:24:25<39:40, 12.40s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  59%|█████▊    | 270/461 [1:24:26<28:28,  8.95s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  59%|█████▉    | 271/461 [1:24:31<24:29,  7.74s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  59%|█████▉    | 272/461 [1:24:35<21:21,  6.78s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  59%|█████▉    | 273/461 [1:25:23<59:49, 19.09s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  59%|█████▉    | 274/461 [1:25:27<45:23, 14.57s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  60%|█████▉    | 275/461 [1:25:59<1:00:56, 19.66s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  60%|█████▉    | 276/461 [1:26:19<1:01:18, 19.88s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  60%|██████    | 277/461 [1:27:05<1:24:36, 27.59s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  60%|██████    | 278/461 [1:27:18<1:10:41, 23.18s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  61%|██████    | 279/461 [1:27:55<1:22:51, 27.32s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  61%|██████    | 280/461 [1:27:56<58:54, 19.53s/stock]  "
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  61%|██████    | 281/461 [1:28:58<1:36:38, 32.21s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  61%|██████    | 282/461 [1:29:14<1:21:55, 27.46s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  61%|██████▏   | 283/461 [1:29:15<58:15, 19.64s/stock]  "
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  62%|██████▏   | 284/461 [1:30:00<1:20:01, 27.13s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  62%|██████▏   | 285/461 [1:30:13<1:06:56, 22.82s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  62%|██████▏   | 286/461 [1:31:17<1:42:59, 35.31s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  62%|██████▏   | 287/461 [1:31:20<1:13:44, 25.43s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  62%|██████▏   | 288/461 [1:31:22<53:03, 18.40s/stock]  "
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  63%|██████▎   | 289/461 [1:31:22<37:20, 13.02s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  63%|██████▎   | 290/461 [1:31:35<37:10, 13.04s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  63%|██████▎   | 291/461 [1:31:37<26:58,  9.52s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  63%|██████▎   | 292/461 [1:31:39<21:17,  7.56s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  64%|██████▎   | 293/461 [1:31:40<15:10,  5.42s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  64%|██████▍   | 294/461 [1:31:43<13:16,  4.77s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  64%|██████▍   | 295/461 [1:31:47<12:11,  4.41s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  64%|██████▍   | 296/461 [1:31:50<11:17,  4.11s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  64%|██████▍   | 297/461 [1:31:51<08:20,  3.05s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  65%|██████▍   | 298/461 [1:31:54<08:09,  3.00s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  65%|██████▍   | 299/461 [1:31:56<07:18,  2.71s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  65%|██████▌   | 300/461 [1:31:56<05:42,  2.13s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  65%|██████▌   | 301/461 [1:31:59<06:21,  2.39s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  66%|██████▌   | 302/461 [1:32:00<04:41,  1.77s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  66%|██████▌   | 303/461 [1:32:12<12:54,  4.90s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  66%|██████▌   | 304/461 [1:32:13<09:33,  3.66s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  66%|██████▌   | 305/461 [1:32:15<08:41,  3.34s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  66%|██████▋   | 306/461 [1:32:16<06:25,  2.49s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  67%|██████▋   | 307/461 [1:32:31<16:17,  6.35s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  67%|██████▋   | 308/461 [1:32:32<12:04,  4.74s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  67%|██████▋   | 309/461 [1:32:33<09:02,  3.57s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  67%|██████▋   | 310/461 [1:32:38<10:11,  4.05s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  67%|██████▋   | 311/461 [1:32:39<07:55,  3.17s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  68%|██████▊   | 312/461 [1:33:28<41:46, 16.82s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  68%|██████▊   | 313/461 [1:34:29<1:14:22, 30.15s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  68%|██████▊   | 314/461 [1:34:36<56:59, 23.26s/stock]  "
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  68%|██████▊   | 315/461 [1:34:43<44:28, 18.28s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  69%|██████▊   | 316/461 [1:35:18<55:55, 23.14s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  69%|██████▉   | 317/461 [1:36:05<1:12:57, 30.40s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  69%|██████▉   | 318/461 [1:36:50<1:23:09, 34.89s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  69%|██████▉   | 319/461 [1:37:10<1:11:32, 30.23s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  69%|██████▉   | 320/461 [1:37:57<1:23:15, 35.43s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  70%|██████▉   | 321/461 [1:37:58<58:44, 25.18s/stock]  "
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  70%|██████▉   | 322/461 [1:38:42<1:10:56, 30.62s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  70%|███████   | 323/461 [1:38:55<58:40, 25.51s/stock]  "
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  70%|███████   | 324/461 [1:39:44<1:14:09, 32.48s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  70%|███████   | 325/461 [1:40:31<1:23:25, 36.81s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  71%|███████   | 326/461 [1:41:28<1:36:29, 42.89s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  71%|███████   | 327/461 [1:41:29<1:07:59, 30.45s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  71%|███████   | 328/461 [1:42:20<1:20:45, 36.43s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  71%|███████▏  | 329/461 [1:43:20<1:35:48, 43.55s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  72%|███████▏  | 330/461 [1:43:22<1:07:35, 30.96s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  72%|███████▏  | 331/461 [1:43:23<47:42, 22.02s/stock]  "
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  72%|███████▏  | 332/461 [1:43:54<53:36, 24.94s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  72%|███████▏  | 333/461 [1:43:56<38:05, 17.85s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  72%|███████▏  | 334/461 [1:44:59<1:06:18, 31.33s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  73%|███████▎  | 335/461 [1:45:58<1:23:42, 39.86s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  73%|███████▎  | 336/461 [1:47:04<1:38:58, 47.51s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  73%|███████▎  | 337/461 [1:47:13<1:14:21, 35.98s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  73%|███████▎  | 338/461 [1:47:54<1:16:43, 37.43s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  74%|███████▎  | 339/461 [1:48:29<1:14:57, 36.86s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  74%|███████▍  | 340/461 [1:48:30<52:43, 26.14s/stock]  "
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  74%|███████▍  | 341/461 [1:48:47<46:24, 23.20s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  74%|███████▍  | 342/461 [1:48:48<33:00, 16.64s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  74%|███████▍  | 343/461 [1:49:34<50:22, 25.61s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  75%|███████▍  | 344/461 [1:49:43<39:39, 20.34s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  75%|███████▍  | 345/461 [1:50:29<54:23, 28.13s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  75%|███████▌  | 346/461 [1:50:31<38:51, 20.28s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  75%|███████▌  | 347/461 [1:51:16<52:37, 27.69s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  75%|███████▌  | 348/461 [1:51:17<37:15, 19.78s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  76%|███████▌  | 349/461 [1:51:21<27:45, 14.87s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  76%|███████▌  | 350/461 [1:51:21<19:46, 10.69s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  76%|███████▌  | 351/461 [1:51:29<17:39,  9.63s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  76%|███████▋  | 352/461 [1:51:30<12:52,  7.09s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  77%|███████▋  | 353/461 [1:52:15<33:05, 18.39s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  77%|███████▋  | 354/461 [1:53:00<47:12, 26.47s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  77%|███████▋  | 355/461 [1:53:41<54:46, 31.00s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  77%|███████▋  | 356/461 [1:53:42<38:28, 21.99s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  77%|███████▋  | 357/461 [1:53:43<27:12, 15.69s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  78%|███████▊  | 358/461 [1:53:59<27:02, 15.75s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  78%|███████▊  | 359/461 [1:54:34<36:21, 21.39s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  78%|███████▊  | 360/461 [1:55:11<44:06, 26.20s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  78%|███████▊  | 361/461 [1:55:47<48:17, 28.98s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  79%|███████▊  | 362/461 [1:56:02<41:16, 25.01s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  79%|███████▊  | 363/461 [1:56:48<50:40, 31.02s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  79%|███████▉  | 364/461 [1:56:48<35:34, 22.01s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  79%|███████▉  | 365/461 [1:57:30<44:22, 27.73s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  79%|███████▉  | 366/461 [1:57:53<42:02, 26.55s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  80%|███████▉  | 367/461 [1:57:54<29:37, 18.91s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  80%|███████▉  | 368/461 [1:58:10<27:52, 17.99s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  80%|████████  | 369/461 [1:58:11<19:40, 12.84s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  80%|████████  | 370/461 [1:58:57<34:36, 22.82s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  80%|████████  | 371/461 [1:59:10<29:53, 19.93s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  81%|████████  | 372/461 [1:59:26<27:34, 18.59s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  81%|████████  | 373/461 [2:00:04<35:48, 24.42s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  81%|████████  | 374/461 [2:00:44<42:18, 29.17s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  81%|████████▏ | 375/461 [2:01:43<54:38, 38.13s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  82%|████████▏ | 376/461 [2:02:17<52:19, 36.94s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  82%|████████▏ | 377/461 [2:02:19<36:56, 26.38s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  82%|████████▏ | 378/461 [2:02:56<40:54, 29.57s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  82%|████████▏ | 379/461 [2:03:13<35:13, 25.77s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  82%|████████▏ | 380/461 [2:03:14<24:42, 18.30s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  83%|████████▎ | 381/461 [2:03:15<17:26, 13.08s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  83%|████████▎ | 382/461 [2:03:29<17:44, 13.47s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  83%|████████▎ | 383/461 [2:03:30<12:45,  9.81s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  83%|████████▎ | 384/461 [2:04:17<26:40, 20.79s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  84%|████████▎ | 385/461 [2:05:00<34:59, 27.63s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  84%|████████▎ | 386/461 [2:05:41<39:23, 31.52s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  84%|████████▍ | 387/461 [2:06:24<42:57, 34.83s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  84%|████████▍ | 388/461 [2:07:06<45:09, 37.12s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  84%|████████▍ | 389/461 [2:07:41<43:50, 36.54s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  85%|████████▍ | 390/461 [2:08:18<43:20, 36.62s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  85%|████████▍ | 391/461 [2:08:27<33:07, 28.39s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  85%|████████▌ | 392/461 [2:08:28<23:17, 20.25s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  85%|████████▌ | 393/461 [2:08:30<16:40, 14.72s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  85%|████████▌ | 394/461 [2:08:31<11:54, 10.67s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  86%|████████▌ | 395/461 [2:08:33<08:39,  7.87s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  86%|████████▌ | 396/461 [2:08:50<11:42, 10.81s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  86%|████████▌ | 397/461 [2:09:17<16:39, 15.62s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  86%|████████▋ | 398/461 [2:09:53<22:49, 21.74s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  87%|████████▋ | 399/461 [2:09:55<16:04, 15.56s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  87%|████████▋ | 400/461 [2:09:56<11:24, 11.22s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  87%|████████▋ | 401/461 [2:10:24<16:24, 16.40s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  87%|████████▋ | 402/461 [2:11:07<23:49, 24.22s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  87%|████████▋ | 403/461 [2:12:05<33:24, 34.57s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  88%|████████▊ | 404/461 [2:12:43<33:40, 35.44s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  88%|████████▊ | 405/461 [2:12:52<25:51, 27.70s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  88%|████████▊ | 406/461 [2:13:26<27:02, 29.49s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  88%|████████▊ | 407/461 [2:13:27<18:54, 21.02s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  89%|████████▊ | 408/461 [2:14:10<24:19, 27.54s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  89%|████████▊ | 409/461 [2:14:11<17:03, 19.69s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  89%|████████▉ | 410/461 [2:14:12<11:50, 13.94s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  89%|████████▉ | 411/461 [2:14:31<12:46, 15.33s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  89%|████████▉ | 412/461 [2:14:37<10:22, 12.69s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  90%|████████▉ | 413/461 [2:15:19<17:15, 21.57s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  90%|████████▉ | 414/461 [2:15:20<12:04, 15.41s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  90%|█████████ | 415/461 [2:15:22<08:31, 11.12s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  90%|█████████ | 416/461 [2:15:59<14:15, 19.02s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  90%|█████████ | 417/461 [2:16:41<18:54, 25.78s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  91%|█████████ | 418/461 [2:16:53<15:35, 21.75s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  91%|█████████ | 419/461 [2:17:32<18:51, 26.95s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  91%|█████████ | 420/461 [2:17:33<13:07, 19.21s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  91%|█████████▏| 421/461 [2:17:34<09:12, 13.81s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  92%|█████████▏| 422/461 [2:18:26<16:23, 25.23s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  92%|█████████▏| 423/461 [2:18:28<11:27, 18.09s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  92%|█████████▏| 424/461 [2:18:29<08:02, 13.04s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  92%|█████████▏| 425/461 [2:18:54<10:02, 16.74s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  92%|█████████▏| 426/461 [2:19:38<14:24, 24.71s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  93%|█████████▎| 427/461 [2:20:01<13:48, 24.37s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  93%|█████████▎| 428/461 [2:20:15<11:35, 21.08s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  93%|█████████▎| 429/461 [2:20:27<09:49, 18.41s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  93%|█████████▎| 430/461 [2:20:28<06:50, 13.26s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  93%|█████████▎| 431/461 [2:20:29<04:44,  9.48s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  94%|█████████▎| 432/461 [2:21:20<10:36, 21.95s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  94%|█████████▍| 433/461 [2:22:02<13:03, 27.97s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  94%|█████████▍| 434/461 [2:22:02<08:55, 19.83s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  94%|█████████▍| 435/461 [2:22:06<06:24, 14.78s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  95%|█████████▍| 436/461 [2:22:06<04:25, 10.61s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  95%|█████████▍| 437/461 [2:22:24<05:08, 12.85s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  95%|█████████▌| 438/461 [2:22:58<07:16, 18.99s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  95%|█████████▌| 439/461 [2:23:13<06:31, 17.78s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  95%|█████████▌| 440/461 [2:23:14<04:28, 12.80s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  96%|█████████▌| 441/461 [2:23:15<03:05,  9.29s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  96%|█████████▌| 442/461 [2:23:16<02:11,  6.89s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  96%|█████████▌| 443/461 [2:23:58<05:14, 17.48s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  96%|█████████▋| 444/461 [2:24:51<07:55, 27.97s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  97%|█████████▋| 445/461 [2:25:17<07:16, 27.29s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  97%|█████████▋| 446/461 [2:25:21<05:08, 20.54s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  97%|█████████▋| 447/461 [2:26:20<07:26, 31.87s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  97%|█████████▋| 448/461 [2:26:26<05:12, 24.04s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  97%|█████████▋| 449/461 [2:26:56<05:13, 26.09s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  98%|█████████▊| 450/461 [2:27:07<03:56, 21.54s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  98%|█████████▊| 451/461 [2:27:16<02:57, 17.78s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  98%|█████████▊| 452/461 [2:27:17<01:54, 12.73s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  98%|█████████▊| 453/461 [2:27:24<01:27, 10.88s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  98%|█████████▊| 454/461 [2:27:25<00:55,  7.93s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  99%|█████████▊| 455/461 [2:27:26<00:35,  5.88s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  99%|█████████▉| 456/461 [2:27:27<00:22,  4.41s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  99%|█████████▉| 457/461 [2:27:38<00:26,  6.55s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data:  99%|█████████▉| 458/461 [2:27:40<00:14,  4.97s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data: 100%|█████████▉| 459/461 [2:27:45<00:10,  5.15s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data: 100%|█████████▉| 460/461 [2:28:13<00:11, 11.92s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data: 100%|██████████| 461/461 [2:28:14<00:00,  8.57s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\r",
      "Fetching data: 100%|██████████| 461/461 [2:28:14<00:00, 19.29s/stock]"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\n"
     ]
    }
   ],
   "source": [
    "all_stocks_data = []  # Initialize an empty list to store individual stock data\n",
    "failed_stocks=[]\n",
    "total_stocks = len(stocks)\n",
    "\n",
    "for stock in tqdm(stocks[461:922], desc=\"Fetching data\", unit=\"stock\"):\n",
    "  try:\n",
    "    short_df=DataFetcher(stock)\n",
    "  except:\n",
    "    failed_stocks.append(stock)\n",
    "    continue\n",
    "  if get_market_cap(stock) >=970 or get_market_cap(stock) == -1:\n",
    "    try:\n",
    "      short_df=main(short_df)\n",
    "      short_df['Symbol'] = stock\n",
    "      all_stocks_data.append(short_df)\n",
    "    except:\n",
    "      continue\n",
    "\n",
    "all_stocks_df = pd.concat(all_stocks_data)  # Concatenate all stock dataframes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "2e0b898b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-06-03T15:27:55.867234Z",
     "iopub.status.busy": "2024-06-03T15:27:55.866236Z",
     "iopub.status.idle": "2024-06-03T15:27:56.827898Z",
     "shell.execute_reply": "2024-06-03T15:27:56.826220Z"
    },
    "id": "sGSi4oQFKcKQ",
    "papermill": {
     "duration": 1.048093,
     "end_time": "2024-06-03T15:27:56.831935",
     "exception": false,
     "start_time": "2024-06-03T15:27:55.783842",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "all_stocks_df['Market Cap cr'] = all_stocks_df['Symbol'].apply(get_market_cap)\n",
    "all_stocks_df.to_csv('knn_all_stocks_2.csv', index=False)"
   ]
  }
 ],
 "metadata": {
  "colab": {
   "provenance": []
  },
  "kernelspec": {
   "display_name": "Python 3",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.11"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 8899.652149,
   "end_time": "2024-06-03T15:27:57.512704",
   "environment_variables": {},
   "exception": null,
   "input_path": "KNN_SUPERTREND_ITER_2.ipynb",
   "output_path": "null",
   "parameters": {},
   "start_time": "2024-06-03T12:59:37.860555",
   "version": "2.5.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}